<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Spring DB - 스프링 트랜잭션의 이해" /><meta property="og:locale" content="en" /><meta name="description" content="트랜잭션 적용 확인 @Transactional을 통해 선언적 트랜잭션 방식을 사용하면 다눈히 어노테이션 하나로 트랜잭션을 적용할 수 있음 제대로 적용 되었는지 아래와 같이 확인 해 볼 수 있음" /><meta property="og:description" content="트랜잭션 적용 확인 @Transactional을 통해 선언적 트랜잭션 방식을 사용하면 다눈히 어노테이션 하나로 트랜잭션을 적용할 수 있음 제대로 적용 되었는지 아래와 같이 확인 해 볼 수 있음" /><link rel="canonical" href="https://issuh.github.io/posts/spring-db-07/" /><meta property="og:url" content="https://issuh.github.io/posts/spring-db-07/" /><meta property="og:site_name" content="My Technical Diary" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-10-18T10:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Spring DB - 스프링 트랜잭션의 이해" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-11-02T14:05:31+09:00","datePublished":"2023-10-18T10:00:00+09:00","description":"트랜잭션 적용 확인 @Transactional을 통해 선언적 트랜잭션 방식을 사용하면 다눈히 어노테이션 하나로 트랜잭션을 적용할 수 있음 제대로 적용 되었는지 아래와 같이 확인 해 볼 수 있음","headline":"Spring DB - 스프링 트랜잭션의 이해","mainEntityOfPage":{"@type":"WebPage","@id":"https://issuh.github.io/posts/spring-db-07/"},"url":"https://issuh.github.io/posts/spring-db-07/"}</script><title>Spring DB - 스프링 트랜잭션의 이해 | My Technical Diary</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="My Technical Diary"><meta name="application-name" content="My Technical Diary"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/profile.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">My Technical Diary</a></div><div class="site-subtitle font-italic">ISSuh's tech blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/aboutme/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/ISSuh" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['yoyus5','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Spring DB - 스프링 트랜잭션의 이해</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Spring DB - 스프링 트랜잭션의 이해</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/ISSuh">ISSuh</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1697590800" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-10-18 </em> </span> <span> Updated <em class="timeago" data-ts="1698901531" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-11-02 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3738 words"> <em>20 min</em> read</span></div></div></div><div class="post-content"><h3 id="트랜잭션-적용-확인"><span class="mr-2">트랜잭션 적용 확인</span><a href="#트랜잭션-적용-확인" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>@Transactional을 통해 선언적 트랜잭션 방식을 사용하면 다눈히 어노테이션 하나로 트랜잭션을 적용할 수 있음 제대로 적용 되었는지 아래와 같이 확인 해 볼 수 있음</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TxBasicTest</span> <span class="o">{</span>

  <span class="nd">@Autowired</span>
  <span class="nc">BasicService</span> <span class="n">basicService</span><span class="o">;</span>

  <span class="nd">@Test</span>
  <span class="kt">void</span> <span class="nf">proxyCheck</span><span class="o">()</span> <span class="o">{</span>
      <span class="c1">//BasicService$$EnhancerBySpringCGLIB...</span>
      <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"aop class={}"</span><span class="o">,</span> <span class="n">basicService</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span>
      <span class="n">assertThat</span><span class="o">(</span><span class="nc">AopUtils</span><span class="o">.</span><span class="na">isAopProxy</span><span class="o">(</span><span class="n">basicService</span><span class="o">)).</span><span class="na">isTrue</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="o">...</span>

  <span class="kd">static</span> <span class="kd">class</span> <span class="nc">BasicService</span> <span class="o">{</span>
      <span class="nd">@Transactional</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">tx</span><span class="o">()</span> <span class="o">{</span>
          <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"call tx"</span><span class="o">);</span>
          <span class="kt">boolean</span> <span class="n">txActive</span> <span class="o">=</span> <span class="nc">TransactionSynchronizationManager</span><span class="o">.</span><span class="na">isActualTransactionActive</span><span class="o">();</span>
          <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"tx active={}"</span><span class="o">,</span> <span class="n">txActive</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">nonTx</span><span class="o">()</span> <span class="o">{</span>
          <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"call nonTx"</span><span class="o">);</span>
          <span class="kt">boolean</span> <span class="n">txActive</span> <span class="o">=</span> <span class="nc">TransactionSynchronizationManager</span><span class="o">.</span><span class="na">isActualTransactionActive</span><span class="o">();</span>
          <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"tx active={}"</span><span class="o">,</span> <span class="n">txActive</span><span class="o">);</span>
      <span class="o">}</span>
  <span class="o">}</span>

  <span class="o">...</span>

<span class="o">}</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TxBasicTest : aop class=class ..$BasicService$$EnhancerBySpringCGLIB$$xxxxxx
</pre></table></code></div></div><p>위 테스트의 결과를 확인해보면 클래스 이름이 프록시 클래스의 이름으로 출력되는 것을 확인 할 수 있음</p><h4 id="스프링-컨테이너에-트랜잭션-프록시-등록"><span class="mr-2">스프링 컨테이너에 트랜잭션 프록시 등록</span><a href="#스프링-컨테이너에-트랜잭션-프록시-등록" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_07_01.png" alt="Alt text" data-proofer-ignore></p><ul><li>@Transactional 어노테이션이 특정 클래스나 메서드에 하나라도 있으면 트랜잭션 AOP는 프록시를 만들어서 스프링 컨테이너에 등록<ul><li>실제 baseService 객체 대신에 프록시인 basicService$$CGLIB 을 스프링 빈에 등록<li>프록시 내부는 실제 baseService 객체를 참조<li>핵심은 실제 객체 대신에 프록시가 스프링 컨테이너에 등록되었다는 것</ul><li>클라이언트인 txBasicTest는 스프링 컨테이너에 @Autowired로 의존관계 주입 요청할때, 스프링 컨테이너는 실제 객체 대신에 프록시가 스프링 빈으로 등록되어있기 때문에 프록시를 주입<ul><li>프록시는 BasicService를 상속하여 만들어지기 때문에 다형성을 활용할 수 있어 BasicService 대신에 프록시인 BasicService$$CGILB를 주입할 수 있음</ul></ul><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_07_02.png" alt="Alt text" data-proofer-ignore></p><ul><li>클라이언트가 주입받은 BasicService$$CGILB은 트랜잭션을 적용하는 프록시 임</ul><blockquote><p><strong>TransactionSynchronizationManager.isActualTransactionActive()</strong> 현재 쓰레드에 트랜잭션이 적용되었는지 확인할 수 있는 기능 결과가 true 이면 트랜잭션이 적용되어 있는 상태. 트랜잭션의 적용 여부를 가장 확실히 확인할 수 있음</p></blockquote><h3 id="트랜잭션-적용-위치"><span class="mr-2">트랜잭션 적용 위치</span><a href="#트랜잭션-적용-위치" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>스프링에서의 우선순위는 항상 <strong>더 구체적이고 자세한 것이 높은 우선순위를 가짐</strong></p><p>스프링의 @Transactional은 다음과 같은 두가지 규칙이 있음</p><ul><li>우선순위 규칙<li>클래스에 적용하면 메서트는 자동 적용</ul><h4 id="우선순위"><span class="mr-2">우선순위</span><a href="#우선순위" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>트랜잭션을 사용할때는 다양한 옵션을 사용할 수 있음.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nd">@Transactional</span><span class="o">(</span><span class="n">readOnly</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">static</span> <span class="kd">class</span> <span class="nc">LevelService</span> <span class="o">{</span>

    <span class="nd">@Transactional</span><span class="o">(</span><span class="n">readOnly</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">write</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"call write"</span><span class="o">);</span>
        <span class="n">printInfo</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="o">...</span>

<span class="o">}</span>
</pre></table></code></div></div><p>위와 같이 클래스에는 읽기 전용 트랜잭션옵션(@Transactional(readOnly = true)) 이 붙어 있고, 메소드에는 아닌경우, 클래스 보다는 메소드가 더 구체적이므로 메소드에 있는 @Transactional(readOnly = false)가 적용되어 짐</p><h4 id="클래스에-적용되면-메소드는-자동-적용"><span class="mr-2">클래스에 적용되면 메소드는 자동 적용</span><a href="#클래스에-적용되면-메소드는-자동-적용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nd">@Transactional</span><span class="o">(</span><span class="n">readOnly</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">static</span> <span class="kd">class</span> <span class="nc">LevelService</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">read</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"call read"</span><span class="o">);</span>
        <span class="n">printInfo</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="o">...</span>

<span class="o">}</span>
</pre></table></code></div></div><p>위 테스트 코드를 확인해 보면, 메소드에 @Transactional이 없기 떄문에 더 상위 클래스를 확인하게 됨 클래스에는 @Transactional(readOnly = true)이 적용되어 있으므로 메소드도 적용됨</p><blockquote><p>readOnly = true 는 기본옵션이므로 보통 생략 함</p></blockquote><h4 id="인터페이스에-transactional-적용"><span class="mr-2">인터페이스에 @Transactional 적용</span><a href="#인터페이스에-transactional-적용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>인터페이스에서도 @Transactional를 적용할 수 있음. 다만 이경우에도 구체적인 것이 더 우선순위가 높으므로 아래와 같은 우선순위가 적용됨</p><ul><li>클래스의 메소드<li>클래스 타입<li>인터페이스 메소드<li>인터페이스 타입</ul><p>다만 인터페이스에 @Transactional 을 사용하는 것은, 스프링 5.0 이전 버전에서는 AOP가 정상적으로 적용되지 않을 수도 있기 때문에 스프링 공식 메뉴얼에서 권장하지 않는 방법</p><h4 id="public-메소드에만-트랜잭션-적용"><span class="mr-2">public 메소드에만 트랜잭션 적용</span><a href="#public-메소드에만-트랜잭션-적용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>스프링 트랜잭션 AOP 기능은 public 메소드에만 트랜잭션을 적용하도록 기본 설정이 되어 있음. 그러므로 private, protected, package-visible 에는 트랜잭션이 적용되지 않음.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Hello</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">method1</span><span class="o">();</span>
  <span class="n">method2</span><span class="o">():</span>
  <span class="kd">protected</span> <span class="nf">method3</span><span class="o">();</span>
  <span class="kd">private</span> <span class="nf">method4</span><span class="o">();</span>
<span class="o">}</span>
</pre></table></code></div></div><p>만일 위와 같이 트랜잭션이 적용되어 있다면 모든 메소드에 트랜잭션이 걸리게 됨. 그러므로 의도하지 않은 메소드 까지 트랜잭션이 걸리게 되어 트랜잭션이 과도하게 적용되는 문제가 발생함. 트랜잭션은 주로 비지니스 로직의 시작점에 걸기 떄문에 대부분 외부에 열어준 곳을 시작점으로 사용하게 되는데 이때 의도하지 않은 메소드까지 전부 트랜잭션이 걸릴수가 있기 떄문에 public 에만 트랜잭션을 적용하도록 스프링에서 설정되어 있음.</p><blockquote><p>스프링 부트 3.0 부터는 protected, package-visible(default 접근제한자)에도 트랜잭션이 적용됨</p></blockquote><h3 id="트랜잭션-aop-주의-사항---프록시-내부-호출"><span class="mr-2">트랜잭션 AOP 주의 사항 - 프록시 내부 호출</span><a href="#트랜잭션-aop-주의-사항---프록시-내부-호출" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>@Transactional을 사용하면 스프링의 트랜잭션 AOP가 적용됨. 트랜잭션 AOP는 기본적으로 프록시 방식의 AOP를 사용하여 프록새 객체가 요청을 먼저 받아서 트랜잭션을 처리하고 이후 실제 객체를 호출함. 따라서 트랜잭션을 적용하려면 항상 프록시를 통하여 대상 객체(Target)를 호출해야함 만약 프록시를 거치지 않고 대상 객체를 직접 호출하게 되면 AOP가 적용되지 않고 트랜잭션 또한 적용되지 않음.</p><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_07_03.png" alt="Alt text" data-proofer-ignore></p><p>AOP를 적용하면 스프링은 대상 객체 대신에 프록시를 스프링 빈으로 등록함. 따라서 스프링은 의존관계 주입시에 항상 실제 객체 대신에 프록시 객체를 주입함. 프록시 객체가 주입되기 때문에 대상 객체를 직접 호출하는 문제는 일반적으로 발생하지 않으나, <strong>대상 객체의 내부에서 메소드 호출이 발생하면 프록시를 거치지 않고 대상 객체를 직접 호출하는 문제가 발생 함</strong>. 이렇게 되면 AOP가 적용되지 않기 떄문에 @Transactional이 있어도 트랜잭션이 적용되지 않음</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">InternalCallV1Test</span> <span class="o">{</span>

    <span class="o">...</span>

    <span class="nd">@Slf4j</span>
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">CallService</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">external</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"call external"</span><span class="o">);</span>
            <span class="n">printTxInfo</span><span class="o">();</span>
            <span class="n">internal</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="nd">@Transactional</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">internal</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"call internal"</span><span class="o">);</span>
            <span class="n">printTxInfo</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="kd">private</span> <span class="kt">void</span> <span class="nf">printTxInfo</span><span class="o">()</span> <span class="o">{</span>
            <span class="kt">boolean</span> <span class="n">txActive</span> <span class="o">=</span> <span class="nc">TransactionSynchronizationManager</span><span class="o">.</span><span class="na">isActualTransactionActive</span><span class="o">();</span>
            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"tx active = {}"</span><span class="o">,</span> <span class="n">txActive</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">internalCall</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">callService</span><span class="o">.</span><span class="na">internal</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">externalCall</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">callService</span><span class="o">.</span><span class="na">external</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="o">...</span>

</pre></table></code></div></div><p><strong>internalCall() 실행</strong> <img data-src="/assets/posts/img/spring/spring_db_1/spring_db_07_03.png" alt="Alt text" data-proofer-ignore></p><ol><li>클라이언트 테스트 코드는 callService.internal() 호출. 이때 callService는 트랜잭션 프록시 임<li>callService의 트랜잭션 프록시 호출<li>internal() 메소드에 @Transactional이 붙어있으므로 트랜잭션 프록시는 트랜잭션을 적용<li>트랜잭션 적용 후 실제 callService 객체 인스턴스의 internal() 을 호출<li>실제 callService 가 처리를 완료하면 응답이 트랜잭션 프록시로 돌아오고 트랜잭션 프록시는 트랜잭션을 완료</ol><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>TransactionInterceptor           : Getting transaction for 
[..CallService.internal]
..rnalCallV1Test$CallService     : call internal
..rnalCallV1Test$CallService     : tx active=true
TransactionInterceptor           : Completing transaction for 
[..CallService.internal]
</pre></table></code></div></div><p><strong>externalCall() 실행</strong> <img data-src="/assets/posts/img/spring/spring_db_1/spring_db_07_04.png" alt="Alt text" data-proofer-ignore></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>CallService     : call external
CallService     : tx active=false
CallService     : call internal
CallService     : tx active=false
</pre></table></code></div></div><p>위 경우에, 실행 결과를 보면 트랜잭션관련 코드 및 tx active=false 로 로그가 출력되는 것으로 봐 태랜잭션이 적용되지 않음을 확인 할 수 있음. 해당 내용에 대한 이유는 프록시가 아닌 실제 객체의 내부 메소드를 호출해서 발생함</p><h4 id="프록시와-내부-호출"><span class="mr-2">프록시와 내부 호출</span><a href="#프록시와-내부-호출" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_07_05.png" alt="Alt text" data-proofer-ignore></p><ol><li>클라이언트 테스트 코드는 callService.external() 호출. 이때 callService는 트랜잭션 프록시 임<li>callService의 트랜잭션 프록시 호출<li>internal() 메소드에 @Transactional이 없으므로 트랜잭션 프록시는 트랜잭션을 적용하지 않음<li>트랜잭션 적용하지 않고 실제 callService 객체 인스턴스의 external() 을 호출<li>external()은 내부에서 internal() 메소드를 호출하지만 이는 트랜잭션 프록시 객체의 internal() 이 아닌 실제 객체의 internal() 메소드를 호출하는 것이므로 트랜잭션을 수행하지 않음</ol><h4 id="프록시-방식의-aop-한계"><span class="mr-2">프록시 방식의 AOP 한계</span><a href="#프록시-방식의-aop-한계" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>위와 같은 상황의 문제 원인으로는 자바 언어에서는 메소드 앞에 별도의 참조가 없다면 this 라는 뜻으로 자기 자신의 인스턴스를 가리킴. 결과적으로 자기자신의 내부 메소드를 호출하는 this.internal()이 되는데, 이떄 this 는 자기 자신을 가리키므로 실제 대상 객체(Target)의 인스턴스를 뜻함. 그러므로 결과적으로 이러한 내부 호출은 프록시를 커치지 못하여 트랜잭션을 적용할 수 없음.</p><p>@Transactional을 사용하는 트랜잭션 AOP는 프록시를 사용함. 프록시를 사용하면 메소드 내부 호출에는 프록시를 적용 할 수 없음.</p><h5 id="내부-호출문제-해결방안"><span class="mr-2">내부 호출문제 해결방안</span><a href="#내부-호출문제-해결방안" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><p>메소드 내부 호출로 인하여 트랜잭션 프록시가 적용되지 않는 문제에 대하여, 가장 간단한 해결 방안은 internal() 메서드를 별도의 클래스로 분리하는 것</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">InternalCallV1Test</span> <span class="o">{</span>

    <span class="o">...</span>

    <span class="nd">@Slf4j</span>
    <span class="nd">@RequiredArgsConstructor</span>
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">CallService</span> <span class="o">{</span>

        <span class="kd">private</span> <span class="kd">final</span> <span class="nc">InternalService</span> <span class="n">internalService</span><span class="o">;</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">external</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"call external"</span><span class="o">);</span>
            <span class="n">printTxInfo</span><span class="o">();</span>
            <span class="n">internalService</span><span class="o">.</span><span class="na">internal</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="kd">private</span> <span class="kt">void</span> <span class="nf">printTxInfo</span><span class="o">()</span> <span class="o">{</span>
            <span class="kt">boolean</span> <span class="n">txActive</span> <span class="o">=</span> <span class="nc">TransactionSynchronizationManager</span><span class="o">.</span><span class="na">isActualTransactionActive</span><span class="o">();</span>
            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"tx active = {}"</span><span class="o">,</span> <span class="n">txActive</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">InternalService</span> <span class="o">{</span>

        <span class="nd">@Transactional</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">internal</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"call internal"</span><span class="o">);</span>
            <span class="n">printTxInfo</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="kd">private</span> <span class="kt">void</span> <span class="nf">printTxInfo</span><span class="o">()</span> <span class="o">{</span>
            <span class="kt">boolean</span> <span class="n">txActive</span> <span class="o">=</span> <span class="nc">TransactionSynchronizationManager</span><span class="o">.</span><span class="na">isActualTransactionActive</span><span class="o">();</span>
            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"tx active={}"</span><span class="o">,</span> <span class="n">txActive</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="o">...</span>

</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>#external()
..InternalCallV2Test$CallService : call external
..InternalCallV2Test$CallService : tx active=false

#internal()
TransactionInterceptor           : Getting transaction for 
[..InternalService.internal]
..rnalCallV2Test$InternalService : call internal
..rnalCallV2Test$InternalService : tx active=true
TransactionInterceptor           : Completing transaction for 
[..InternalService.internal]
</pre></table></code></div></div><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_07_06.png" alt="Alt text" data-proofer-ignore></p><ol><li>클라이언트 테스트 코드는 callService.external() 호출.<li>callService는 클래스 외부, 내부에 @Transactional이 없으므로 실제 객체임 임<li>callService는 주입 받은 internalService.internal()을 호출<li>internalService는 트랜잭션 프록시이며 internal() 메소드에 @Transactional이 붙어 있으므로 트랜잭션 프록시는 트랜잭션을 적용<li>트랜잭션 적용 후 실제 internalService 객체 인스턴스의 internal()을 호출</ol><h3 id="트랜잭션-aop-주의-사항---초기화-시점"><span class="mr-2">트랜잭션 AOP 주의 사항 - 초기화 시점</span><a href="#트랜잭션-aop-주의-사항---초기화-시점" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>초기화 코드(예: @PostConstruct)와 @Transactional을 함꼐 사용하면 트랜잭션이 적용되지 않음.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nd">@PostConstruct</span>
<span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
  <span class="kt">boolean</span> <span class="n">isActive</span> <span class="o">=</span> <span class="nc">TransactionSynchronizationManager</span><span class="o">.</span><span class="na">isActualTransactionActive</span><span class="o">();</span>
  <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Hello init @PostConstruct tx active={}"</span><span class="o">,</span> <span class="n">isActive</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Hello init @PostConstruct tx active=false
</pre></table></code></div></div><p>이는 트랜잭션 AOP를 포함한 스프링 컨테이너가 완전히 생성되기도 전에 해당 초기화 코드가 호출되어 AOP가 적용되지 못하여 발생하는 문제.</p><p>이를 해결하기 위해 @PostConstruct 와 같은 초기화 방법이 아닌 ApplicationReadyEvent 이벤트를 사용하여 초기화에 이용하면 해결 됨</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nd">@EventListener</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="nc">ApplicationReadyEvent</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
  <span class="kt">boolean</span> <span class="n">isActive</span> <span class="o">=</span> <span class="nc">TransactionSynchronizationManager</span><span class="o">.</span><span class="na">isActualTransactionActive</span><span class="o">();</span>
  <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Hello init @PostConstruct tx active={}"</span><span class="o">,</span> <span class="n">isActive</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>TransactionInterceptor           : Getting transaction for [Hello.init]
..ngtx.apply.InitTxTest$Hello    : Hello init ApplicationReadyEvent tx 
active=true
TransactionInterceptor           : Completing transaction for [Hello.init]
</pre></table></code></div></div><p>이 ApplicationReadyEvent 이벤트는 트랜잭션 AOP를 포함한 스프링 컨테이너가 완전히 생성되고 난 다음에 이벤트가 붙은 메소드를 호출하기 떄문에 트랜잭션을 적용할 수 있음.</p><h3 id="예외와-트랜잭션-커밋-롤백"><span class="mr-2">예외와 트랜잭션 커밋, 롤백</span><a href="#예외와-트랜잭션-커밋-롤백" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_07_07.png" alt="Alt text" data-proofer-ignore></p><ul><li>예외 발생시 스프링 트랜잭션 AOP는 예외의 종류에 따라 트랜잭션을 커밋하거나 롤백 함<ul><li>언체크 예외인 RuntimeException, Error와 그 하위 예외가 발생하면 트랜잭션을 롤백<li>체크 예외인 Exception과 그 하위 예외가 발생하면 트랜잭션을 커밋<li>정상 응답(리터)시 트랜잭션을 커밋</ul></ul><p>스프링은 기본적으로 체크 예외는 비지니스 의미가 있을때 사용하고, 런타임(언체크) 예외는 복구 불가능한 예외로 가정함</p><ul><li>체크 예외 : 비지니스 의미가 있을때 사용<li>언체크 예외 : 복구 불가능한 예외</ul><p>그러나 이는 필수가 아니며, 개발자가 rollbackFor라는 옵션을 통해 체크 예외에도 롤백이 가능함</p><h4 id="비지니스-예외"><span class="mr-2">비지니스 예외</span><a href="#비지니스-예외" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>비지니스 예외라는 내용에 대하여 예시를 통해 설명하면 아래와 같음</p><p>주문을 하는데 있어 비지니스 요구사항을 아래와 같이 가정함</p><ul><li>정상 : 주문시 결제를 성공하면 주문 데이터를 저장하고 결제 상태를 완료 처리<li>시스템 예외 : 주문시 내부에 복구 불가능한 예외가 발생하면 전체 데이터 롤백 처리<li>비지니스 예외 : 주문시 고객의 결제 잔고가 부족하면 주문 데이터를 저장하고 결제 상태를 대기로 처리하고 고객에게 잔고 부족을 알리고 별도의 계좌로 입급하도록 안내</ul><p>위와 같은 상황일떄, 결제 잔고가 부족하면 NotEnoughMoneyException 예외가 발생한다고 가정한다면, 이 예외는 시스템에 문제가 있어 발생하는 시스템 예외가 아님. 시스템은 정상 동작 했지만 비지니스 상황에서 문제가 되기 떄문에 발생한 예외. 이와 같은 상황을 비지니스 예외라고 함. 이러한 비지니스 예외는 매우 중요하고 반드시 처리해야 하는 경우가 많으므로 주로 체크 예외를 고려 할 수 있음.</p><h4 id="예외에-대한-정리"><span class="mr-2">예외에 대한 정리</span><a href="#예외에-대한-정리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li>스프링의 기본값은 체크 예외일떄는 커밋, 언체크 예외일떄는 롤백을 수행 함<li>비지니스 상황에 다라 체크 예외의 경우에도 트랜잭션을 커밋하지 않고 롤백할 수 있으며 이때는 rollbackFor 옵션 사용<li>런타임 예외는 항상 롤백되며 체크 예외의 경우 rollbackFor 옵션을 사용하여 비지니스 상황에 따라 커밋과 롤백을 선택할 수 있음</ul><hr /><p>참고</p><ul><li>스프링 DB - 데이터 접근 활용 기술(김영한)</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/backend/'>Backend</a>, <a href='/categories/spring-db/'>Spring DB</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/web/" class="post-tag no-text-decoration" >Web</a> <a href="/tags/spring-framework/" class="post-tag no-text-decoration" >Spring Framework</a> <a href="/tags/database/" class="post-tag no-text-decoration" >DataBase</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Spring DB - 스프링 트랜잭션의 이해 - My Technical Diary&amp;url=https://issuh.github.io/posts/spring-db-07/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Spring DB - 스프링 트랜잭션의 이해 - My Technical Diary&amp;u=https://issuh.github.io/posts/spring-db-07/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://issuh.github.io/posts/spring-db-07/&amp;text=Spring DB - 스프링 트랜잭션의 이해 - My Technical Diary" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/educative-distributed-system-10/">Distributed Systems - Coordination Patterns</a><li><a href="/posts/educative-distributed-system-04/">Distributed Systems - CAP</a><li><a href="/posts/educative-distributed-system-03/">Distributed Systems - Replication</a><li><a href="/posts/my_project_simpledb/">simpleDB - 메모리</a><li><a href="/posts/ps-hackerrank-01/">HackerRandk - Fraudulent Activity Notifications</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ps/">PS</a> <a class="post-tag" href="/tags/leetcode/">Leetcode</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/spring-framework/">Spring Framework</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/hash/">Hash</a> <a class="post-tag" href="/tags/database/">DataBase</a> <a class="post-tag" href="/tags/tree/">Tree</a> <a class="post-tag" href="/tags/array/">Array</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/spring-db-01/"><div class="card-body"> <em class="timeago small" data-ts="1697094600" > 2023-10-12 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring DB - JDBC 이해</h3><div class="text-muted small"><p> JDBC 표준 인터페이스 JDBC(Java Database Connectivity)는 자바에서 데이터베이스에 접속 할 수 있도록 하는 자바 API. JDBC는 데이터베이스에서 자료를 쿼리하거나 업데이트 하는 방법을 제공함 대표적으로 다음 3가지 기능을 표준 인터페이스로 정의해서 제공함 java.sql.Connection : 연결 java...</p></div></div></a></div><div class="card"> <a href="/posts/spring-db-02/"><div class="card-body"> <em class="timeago small" data-ts="1697163000" > 2023-10-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring DB - 커넥션풀과 데이터소스 이해</h3><div class="text-muted small"><p> 커넥션 풀 이해 데이터데이스 커넥션을 획득할 떄는 복잡한 과정을 걸치게 됨 어펄리케이션 로직은 DB 드라이버를 통해 커넥션 조회 DB 드라이버는 DB와 TCP/IP 커넥션 연결 DB 드라이버는 TCP/IP 커넥션이 연결되면 ID, PW와 기타 부가정보를 DB에 전달 DB는 ID, PW를 통해 내부 인증을 완료하고 내부에 DB 세션을...</p></div></div></a></div><div class="card"> <a href="/posts/spring-db-03/"><div class="card-body"> <em class="timeago small" data-ts="1697170200" > 2023-10-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring DB - 트랜잭션 이해</h3><div class="text-muted small"><p> 트랜잭션 데이터를 데이터베이스에 저장하는 대표적인 이유는 데이터베이스가 트랜잭션 이라는 개념을 지원하기 때문 트랜잭션이란 데이터베이스에서 하나의 작업을 안전하게 처리하도록 보장해주는 것을 뜻함 예를 들면, A가 B에게 1000원 계좌이체를 한다고 생각했을떄, A의 잔고 1000원 감소 B의 잔고 1000원 증가 위 두가지 작업이 합쳐 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/spring-db-06/" class="btn btn-outline-primary" prompt="Older"><p>Spring DB - 식별자(PK) 선택 전략</p></a> <a href="/posts/spring-db-08/" class="btn btn-outline-primary" prompt="Newer"><p>Spring DB - 스프링 트랜잭션 전파</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/ISSuh">ISSuh</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ps/">PS</a> <a class="post-tag" href="/tags/leetcode/">Leetcode</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/spring-framework/">Spring Framework</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/hash/">Hash</a> <a class="post-tag" href="/tags/database/">DataBase</a> <a class="post-tag" href="/tags/tree/">Tree</a> <a class="post-tag" href="/tags/array/">Array</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-157715138-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-157715138-1'); }); </script>
