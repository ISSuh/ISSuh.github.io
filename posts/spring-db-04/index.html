<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Spring DB - 스프링을 통한 트랜잭션 동작 개선" /><meta property="og:locale" content="en" /><meta name="description" content="어플리케이션 구조 현재 가장 많이 사용하는 어플리케이션의 구조는 역할에 따라 3가지 계층으로 나누는 것" /><meta property="og:description" content="어플리케이션 구조 현재 가장 많이 사용하는 어플리케이션의 구조는 역할에 따라 3가지 계층으로 나누는 것" /><link rel="canonical" href="https://issuh.github.io/posts/spring-db-04/" /><meta property="og:url" content="https://issuh.github.io/posts/spring-db-04/" /><meta property="og:site_name" content="My Technical Diary" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-10-13T16:20:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Spring DB - 스프링을 통한 트랜잭션 동작 개선" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-11-02T12:30:57+09:00","datePublished":"2023-10-13T16:20:00+09:00","description":"어플리케이션 구조 현재 가장 많이 사용하는 어플리케이션의 구조는 역할에 따라 3가지 계층으로 나누는 것","headline":"Spring DB - 스프링을 통한 트랜잭션 동작 개선","mainEntityOfPage":{"@type":"WebPage","@id":"https://issuh.github.io/posts/spring-db-04/"},"url":"https://issuh.github.io/posts/spring-db-04/"}</script><title>Spring DB - 스프링을 통한 트랜잭션 동작 개선 | My Technical Diary</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="My Technical Diary"><meta name="application-name" content="My Technical Diary"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/profile.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">My Technical Diary</a></div><div class="site-subtitle font-italic">ISSuh's tech blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/aboutme/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/ISSuh" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['yoyus5','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Spring DB - 스프링을 통한 트랜잭션 동작 개선</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Spring DB - 스프링을 통한 트랜잭션 동작 개선</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/ISSuh">ISSuh</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1697181600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-10-13 </em> </span> <span> Updated <em class="timeago" data-ts="1698895857" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-11-02 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3678 words"> <em>20 min</em> read</span></div></div></div><div class="post-content"><h3 id="어플리케이션-구조"><span class="mr-2">어플리케이션 구조</span><a href="#어플리케이션-구조" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>현재 가장 많이 사용하는 어플리케이션의 구조는 역할에 따라 3가지 계층으로 나누는 것</p><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_04_01.png" alt="Alt text" data-proofer-ignore></p><ul><li><strong>프리젠테이션 계층</strong><ul><li>UI와 관련된 처리 담당<li>웹 요청과 응답<li>사용자 요청을 검증<li>주 사용 기술 : 서블릿, HTTP와 같은 웹 기술, 스프링 MVC</ul><li><strong>서비스 계층</strong><ul><li>비지니스 로직 담당<li>가급적이면 특정 기술에 의존하지 않고 순수 자바코드로 작성하는 것이 좋음</ul><li><strong>데이터 접근 계층</strong><ul><li>실제 데이터베이스에 접근하는 코드<li>주요 사용 기술 : JDBC, JPA, File, Redis, Mongo DB 등</ul></ul><h4 id="순수한-서비스-계층"><span class="mr-2">순수한 서비스 계층</span><a href="#순수한-서비스-계층" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>보통 핵심 비지니스 로직을 수행하는 서비스 계층이 다른 계층보다 우선시 되곤 함. 시간이 흘러 UI, 웹과 같은 기술이 변하고 데이터 저장 기술 또한 다른 기술로 변한다고 하더라도 비지니스 로직은 최대한 변경 없이 유지되어야 하기 떄문.</p><p>서비스 계층을 최대한 변경없이 유지하려면 특정 기술에 종속적이지 않게 개발해야 함. 그래야 비지니스 로직을 유지보수 하거나 테스트 및 비지니스 로직 변경등에 있어서 수정을 최소화 할 수 있음.</p><h3 id="트랜잭션-추상화"><span class="mr-2">트랜잭션 추상화</span><a href="#트랜잭션-추상화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>구현 기술에 따른 트랜잭션 사용번</p><ul><li>트랜잭션은 원자적 단위의 비지니스 로직을 처리하기 위해 사용됨<li>구현 기술마다 트랜잭션을 사용하는 방법이 다름<ul><li>JDBC : connection.setAudoCommit(false)<li>JPA : transaction.begin()</ul></ul><p>트랜잭션을 사용하는 코드는 데이터 접근 기술마다 다름. 만약 JDBC 기술을 사용해 JDBC 트랜잭션에 의존하다가 JPA 기술로 변경하게 되면 서비스 계층의 트랜잭션을 처리하는 코드를 모두 수정해야함.</p><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_04_02.png" alt="Alt text" data-proofer-ignore></p><ul><li>JDBC 트랜잭션에 의존</ul><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_04_03.png" alt="Alt text" data-proofer-ignore></p><ul><li>JDBC 기술을 사용하다가 JPA 기술로 변경할 시 서비스 계층의 코드를 JPA 기술을 사용하도록 수정해야 함</ul><p>위와 같은 문제를 해결하기 위한 방법중 하나는 아래와 같이 트랜잭션 기능을 추상화 하는 것.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">TxManager</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">begin</span><span class="o">();</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">commit</span><span class="o">();</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">rollback</span><span class="o">();</span>
<span class="o">}</span>
</pre></table></code></div></div><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_04_04.png" alt="Alt text" data-proofer-ignore></p><p>서비스는 특정 트랜잭션 기술에 직접 의존하는 것이 아닌 TxManager 라는 추상화된 인터페이스에 의존하게 함 이후 원하는 구현체를 DI를 통해 주입받아 사용하면 됨. 이렇게 되면 클라이언트인 서비스는 인터페이스에 의존하고 DI를 사용한 덕분에 OCP 원칙을 지킬 수 있음</p><h3 id="스프링의-트랜잭션-추상화-및-동기화"><span class="mr-2">스프링의 트랜잭션 추상화 및 동기화</span><a href="#스프링의-트랜잭션-추상화-및-동기화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>스프링이 제공하는 트랜잭션 매니저는 크게 2가지 역할을 함</p><ul><li>트랜잭션 추상화<li>트랜잭션 동기화</ul><h4 id="스프링의-트랜잭션-추상화"><span class="mr-2">스프링의 트랜잭션 추상화</span><a href="#스프링의-트랜잭션-추상화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>스프링은 이미 위와 같은 트랜잭션 추상화 기능을 제공하고 있음. 또한 각 데이터 접근 기술에 대한 트랜잭션 구현체도 대부분 구현되어 있어 개발자는 단순히 사용만 하면 됨.</p><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_04_05.png" alt="Alt text" data-proofer-ignore></p><ul><li>스프링의 트랜잭션 추상화의 핵심은 PlatformTransactionManager 인터페이스<ul><li>org.springframework.transaction.PlatformTransactionManager</ul></ul><h4 id="스프링의-트랜잭션-동기화"><span class="mr-2">스프링의 트랜잭션 동기화</span><a href="#스프링의-트랜잭션-동기화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>트랜잭션을 유지하려면 트랜잭션의 시작부터 끝까지 같은 데이터베이스 커넥션을 유지하여 세션을 유지해야 함. 결국 같은 커넥션을 동기화하기 위해서 이전에는 파라미터로 커넥션을 전달하는 방법을 사용했지만 해당 방법은 코드의 가독성과 중복 코드등의 여러 단점이 존재 함.</p><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_04_06.png" alt="Alt text" data-proofer-ignore></p><ul><li>스프링은 트랜잭션 동기화 매니저를 제공함<ul><li>트랜잭션 동기화 매니저는 쓰레드 로컬(ThreadLocal)을 사용하여 커넥션을 동기화 해줌<li>트랜잭션 매니저는 내부에서 해당 트랜잭션 동기화 매니저를 사용함</ul><li>트랜잭션 동기화 매니저는 쓰레드 로컬을 사용하기 떄문에 멀티쓰레드 상황에 안전하게 커넥션을 동기화 할 수 있게 해줌. 그러므로 커넥션이 필요하면 트랜잭션 동기화 매니저를 통해 커넥션을 획득하면 됨</ul><p>다음 트랜잭션 동기화 매니저 클래스를 열어서 확인해보면 쓰레드 로컬을 사용하는 것을 알 수 있음</p><ul><li>org.springframework.transaction.support.TransactionSynchronizationManager</ul><blockquote><p>쓰레드 로컬을 사용하면 각각의 쓰레드마다 별도의 저장소가 부여되어 쓰레드는 자기 자신의 저장소의 데이터에만 접근할 수 있음</p></blockquote><h5 id="트랜잭션-동기화-매니저의-동작방식"><span class="mr-2">트랜잭션 동기화 매니저의 동작방식</span><a href="#트랜잭션-동기화-매니저의-동작방식" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><ul><li>트랜잭션의 시작하려면 커넥션이 필요하므로 트랜잭션 매니저는 DataSource를 통해 커넥션을 만들고 트랜잭션을 시작함<li>트랜잭션 매니저는 트랜잭션이 시작된 커넥션을 트랜잭션 동기화 매니저에 보관<li>Repository는 트랜잭션 동기화 매니저에 보관된 커넥션을 꺼내서 사용 함<li>트랜잭션이 종료되면 트랜잭션 매니저는 트랜잭션 동기화 매니저에 보관된 커넥션을 통해 트랜잭션을 종료하고 커넥션을 닫음</ul><h3 id="트랜잭션-매니저의-동작-흐름"><span class="mr-2">트랜잭션 매니저의 동작 흐름</span><a href="#트랜잭션-매니저의-동작-흐름" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_04_07.png" alt="Alt text" data-proofer-ignore></p><ul><li>클라이언트 요청으로 서비스 로직을 실행함<li>서비스계층에서 transactionManager.getTransaction()을 호출하여 트랜잭션 시작<li>트랜잭셕을 시작하려면 데이터베이스 커넥션이 필요하므로 트랜잭션 매니저는 내부에서 데이터 소스를 사용해 커넥션을 생성<li>커넥션을 수동 커밋 모드로 변경하여 실제 데이터베이스 트랜잭션을 시작<li>커넥션을 트랜잭션 동기화 매니저에 보관<li>트랜잭션 동기화 매니저는 쓰레드 로컬에 커넥션을 보관하여 멀티 쓰레드 환경에 안전하게 커넥션을 보관함</ul><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_04_08.png" alt="Alt text" data-proofer-ignore></p><ul><li>서비스는 비지니스 로직을 실행하면서 리포지토리의 메서드를 호출<li>리포지토리 메서드들은 트랜잭션이 시작된 커넥션이 필요하므로 리포지토리는 DataSourceUtils.GetConnection()을 호출하여 트랜잭션 동기화 매니저에 보관된 커넥션을 꺼내어 사용. 이 과정을 통해 같은 커넥션을 사용하고, 트랜잭션도 유지됨<li>획득한 커넥션을 사용하여 SQL을 데이터베이스에 전달하여 실행</ul><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_04_09.png" alt="Alt text" data-proofer-ignore></p><ul><li>비지니스 로직이 끝나고 트랜잭션을 종료. 트랜잭션은 커밋하거나 롤백하면 종료됨<li>트랜잭션을 종료하려면 동기화된 커넥션이 필요하므로 트랜잭션 동기화 매니저를 통해 동기화된 커넥션을 획득<li>획득한 커넥션을 통해 데이터베이스에 트랜잭션을 커밋하거나 롤백함<li>전체 리소스 정리<ul><li>트랜잭션 동기화 매니저를 정리. 쓰레트 로컬은 사용후 반드시 정리해야함<li>connection.setAutoCommit(true) 로 되돌림. 커넥션 풀을 고려해야함<li>connection.clost() 를 호출하여 커넥션을 종료함. 커넥션 풀을 사용하는 경우 connection.clost()를 호출하면 커넥션 풀에 반환됨</ul></ul><h4 id="정리"><span class="mr-2">정리</span><a href="#정리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>트랜잭션 추상화 덕분에 서비스 코드를 이제 JDBC 기술에 의존하지 않음</p><ul><li>이후 JDBC에서 JPA로 변경해도 서비스 코드를 그대로 유지 가능<li>기술 변경시 의존관계 주입만 DataSourceTransactionManager에서 JpaTransactionManager로 변경해주면 됨</ul><h3 id="트랜잭션-템플릿"><span class="mr-2">트랜잭션 템플릿</span><a href="#트랜잭션-템플릿" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>트랜잭션을 사용할때 getTransaction() -&gt; logic -&gt; commit, rollback 과 같이 logic 이외에 반복되는 코드가 존재함 이러한 반복코드를 제거하기 위해 스프링은 템플릿 콜백 패턴을 적용한 클래스를 제공함</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TransactionTemplate</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="nc">PlatformTransactionManager</span> <span class="n">transactionManager</span><span class="o">;</span>
  
  <span class="c1">// return 값이 있을 때 사용</span>
  <span class="kd">public</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="no">T</span> <span class="nf">execute</span><span class="o">(</span><span class="nc">TransactionCallback</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">action</span><span class="o">){..}</span>

  <span class="c1">// return 값이 없을 때 사용</span>
  <span class="kt">void</span> <span class="nf">executeWithoutResult</span><span class="o">(</span><span class="nc">Consumer</span><span class="o">&lt;</span><span class="nc">TransactionStatus</span><span class="o">&gt;</span> <span class="n">action</span><span class="o">){..}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1">// 사용 예시</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">accountTransfer</span><span class="o">(</span><span class="nc">String</span> <span class="n">fromId</span><span class="o">,</span> <span class="nc">String</span> <span class="n">toId</span><span class="o">,</span> <span class="kt">int</span> <span class="n">money</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span> <span class="o">{</span>
    <span class="n">transactionTemplate</span><span class="o">.</span><span class="na">executeWithoutResult</span><span class="o">((</span><span class="n">status</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>

    <span class="c1">// 코드에서 예외를 처리하기 위해  try~catch 가 들어갔는데,  bizLogic()  메서드를 호출하면 </span>
    <span class="c1">// SQLException 체크 예외를 넘겨줌.</span>
    <span class="c1">// 해당 람다에서 체크 예외를 밖으로 던질 수 없기 때문에 언체크 예외로 바꾸어 던지도록 예외를 전환했다</span>
      <span class="k">try</span> <span class="o">{</span>
        <span class="c1">//비즈니스 로직</span>
        <span class="n">bizLogic</span><span class="o">(</span><span class="n">fromId</span><span class="o">,</span> <span class="n">toId</span><span class="o">,</span> <span class="n">money</span><span class="o">);</span>
      <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
      <span class="o">}</span>
    <span class="o">});</span>
  <span class="o">}</span>
</pre></table></code></div></div><ul><li>트랜잭션 템플릿의 기본동작은 다음과 같음<ul><li>비지니스 로직이 정상수행되면 커밋<li>언체크 예외가 발생하면 롤백. 그외의 경우 커밋<ul><li>체크 예외의 경우에는 커밋</ul></ul></ul><h3 id="트랜잭션-aop"><span class="mr-2">트랜잭션 AOP</span><a href="#트랜잭션-aop" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>트랜잭션을 편리하게 처리하기 위해 트랜잭션 추상화와 반복적인 트랜잭션 로직을 해결하기 위해 트랜잭션 템플릿을 도입해봤으나, 서비스 계층에 순수한 비지니스 로직만 남지 않고 트랜잭션 관련 코드가 남는 문제가 존재</p><p>이를 해결하기 위해 스프링 AOP를 통해 프록시를 도입.</p><p><strong>프록시 도입 전</strong> <img data-src="/assets/posts/img/spring/spring_db_1/spring_db_04_10.png" alt="Alt text" data-proofer-ignore></p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c1">//트랜잭션 시작</span>
<span class="nc">TransactionStatus</span> <span class="n">status</span> <span class="o">=</span> <span class="n">transactionManager</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">(</span><span class="k">new</span> 
<span class="nc">DefaultTransactionDefinition</span><span class="o">());</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="c1">//비즈니스 로직</span>
    <span class="n">bizLogic</span><span class="o">(</span><span class="n">fromId</span><span class="o">,</span> <span class="n">toId</span><span class="o">,</span> <span class="n">money</span><span class="o">);</span>
    <span class="n">transactionManager</span><span class="o">.</span><span class="na">commit</span><span class="o">(</span><span class="n">status</span><span class="o">);</span> <span class="c1">//성공시 커밋</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">transactionManager</span><span class="o">.</span><span class="na">rollback</span><span class="o">(</span><span class="n">status</span><span class="o">);</span> <span class="c1">//실패시 롤백</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p><strong>프록시 도입 후</strong> <img data-src="/assets/posts/img/spring/spring_db_1/spring_db_04_11.png" alt="Alt text" data-proofer-ignore></p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="c1">// proxy 코드</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TransactionProxy</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">MemberService</span> <span class="n">target</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">logic</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//트랜잭션 시작</span>
        <span class="nc">TransactionStatus</span> <span class="n">status</span> <span class="o">=</span> <span class="n">transactionManager</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">(..);</span>
        <span class="k">try</span> <span class="o">{</span>
          <span class="c1">//실제 대상 호출</span>
          <span class="n">target</span><span class="o">.</span><span class="na">logic</span><span class="o">();</span>
          <span class="n">transactionManager</span><span class="o">.</span><span class="na">commit</span><span class="o">(</span><span class="n">status</span><span class="o">);</span> <span class="c1">//성공시 커밋</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">transactionManager</span><span class="o">.</span><span class="na">rollback</span><span class="o">(</span><span class="n">status</span><span class="o">);</span> <span class="c1">//실패시 롤백</span>
          <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// service 코드</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Service</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">logic</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//트랜잭션 관련 코드 제거, 순수 비즈니스 로직만 남음</span>
        <span class="n">bizLogic</span><span class="o">(</span><span class="n">fromId</span><span class="o">,</span> <span class="n">toId</span><span class="o">,</span> <span class="n">money</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><ul><li>스프링이 제공하는 AOP 기능을 사용하면 프록시를 매우 편리하게 적용할 수 있음<li>스프링 AOP를 직접 사용해서 트랜잭션을 처리해도 되지만 스프링은 트랜잭션 AOP를 처리하기 위한 모든 기능을 제공함.<ul><li>스프링 부트를 사용하면 트랜잭션 AOP를 처리하기 위해 필요한 스프링 빈들도 자동으로 등록해줌</ul><li>개발자는 트랜잭션 처리가 필요한 곳에 @Transactional 애노테이션만 붙여주면 됨<ul><li>스프링의 트랜잭션 AOP는 이 애노테이션을 인식해서 트랜잭션 프록시를 적용함</ul></ul><p><strong>@Transactional</strong></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>org.springframework.transaction.annotation.Transactional
</pre></table></code></div></div><blockquote><p>참고 스프링 AOP를 적용하려면 어드바이저, 포인트컷, 어드바이스가 필요함. 스프링은 트랜잭션 AOP 처리를 위해 다음 클래스를 제공함. 스프링 부트를 사용하면 해당 빈들은 스프링 컨테이너에 자동으로 등록됨</p><p>어드바이저: BeanFactoryTransactionAttributeSourceAdvisor 포인트컷: TransactionAttributeSourcePointcut 어드바이스: TransactionInterceptor</p></blockquote><h4 id="트랜잭션-aop-적용-전체-흐름"><span class="mr-2">트랜잭션 AOP 적용 전체 흐름</span><a href="#트랜잭션-aop-적용-전체-흐름" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p><img data-src="/assets/posts/img/spring/spring_db_1/spring_db_04_12.png" alt="Alt text" data-proofer-ignore></p><h4 id="선언적-트랜잭션-관리-vs-프로그래밍-방식-트랜잭션-관리"><span class="mr-2">선언적 트랜잭션 관리 vs 프로그래밍 방식 트랜잭션 관리</span><a href="#선언적-트랜잭션-관리-vs-프로그래밍-방식-트랜잭션-관리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li>선언적 트랜잭션 관리(Declarative Transaction Management)<ul><li>@Transactional 어노테이션 하나만 선언하여 편리하게 트랜잭션을 적용하는 방식<li>선언적 트랜잭션 관리가 프로그래밍 방식에 비해 간편하고 실용적이므로 실무에선 주로 선언적 프로그래밍 방식을 사용</ul><li>프로그래밍 방식 트랜잭션 관리(Programmatic transaction management)<ul><li>트랜잭션 매니저 또는 트랜잭션 템플릿 등을 사용하여 트랜잭션 관련 코드를 직접 작성하는 방식<li>스프링 컨테이너나 스프링 AOP 기술 없이 간단히 사용할 수 있지만 실무에서는 대부분 스프링 컨테이너나 스프링 AOP 기술을 사용하기 떄문에 거의 사용되지 않음<li>가끔 테스트시에 사용되기도 함</ul></ul><h3 id="스프링-부트의-자동-리소스-등록"><span class="mr-2">스프링 부트의 자동 리소스 등록</span><a href="#스프링-부트의-자동-리소스-등록" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>스프링 부트가 등작하기 이전에는 데이터소스와 트랜잭션 매니저를 개발자가 직접 스프링 빈으로 등록하여 사용 했음. 이후 스프링 부트에서 많은 부분이 자동화 되면서 데이터 소스와 트랜잭션 매니저 또한 자동으로 등록해줌</p><ul><li>데이터소스 자동등록<ul><li>스프링 부트는 데이터소스(DataSource)를 스프링 빈에 자동으로 등록함<li>자동으로 등록된 스프링 빈 이름은 dataSource</ul><li>트랮잭션 매니저 자동등록<ul><li>스프링 부트는 적절한 트랜잭션 매니저(PlatformTransctionManager)를 자동으로 스프링 빈에 등록함<li>자동으로 등록된 스프링 빈 이름은 transactionManager<li>어떤 트랜잭션 매니저를 선택할지는 현재 등록된 라이브러리를 보고 판단<ul><li>JDBC를 기술을 사용하면 DataSourceTransactionManager를 빈으로 등록하고, JPA를 사용하면 JpaTransactionManager를 빈으로 등록함. 둘다 사용하는 경우 JpaTransactionManager를 등록</ul></ul></ul><p>개발자가 직접 데이터소스나 트랜잭션 매니저를 등록하면 스프링 부트는 자동으로 등록하지 않음</p><p><strong>데이터 소스와 트랜잭션 매니저 자동등록</strong></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre># application.properties
pring.datasource.url=jdbc:h2:tcp://localhost/~/test
spring.datasource.username=sa
spring.datasource.password=
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="nd">@TestConfiguration</span>
  <span class="kd">static</span> <span class="kd">class</span> <span class="nc">TestConfig</span> <span class="o">{</span>
    <span class="c1">// 스프링 부트에서 자동으로 생성된 DataSource를 주입</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">DataSource</span> <span class="n">dataSource</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">TestConfig</span><span class="o">(</span><span class="nc">DataSource</span> <span class="n">dataSource</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">this</span><span class="o">.</span><span class="na">dataSource</span> <span class="o">=</span> <span class="n">dataSource</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="nc">MemberRepositoryV3</span> <span class="nf">memberRepository</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nf">MemberRepositoryV3</span><span class="o">(</span><span class="n">dataSource</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="n">MemberServiceV3_3</span> <span class="nf">memberService</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nf">MemberService</span><span class="o">(</span><span class="n">memberRepository</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>
</pre></table></code></div></div><hr /><p>참고</p><ul><li>스프링 DB - 데이터 접근 핵심 원리(김영한)</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/backend/'>Backend</a>, <a href='/categories/spring-db/'>Spring DB</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/web/" class="post-tag no-text-decoration" >Web</a> <a href="/tags/spring-framework/" class="post-tag no-text-decoration" >Spring Framework</a> <a href="/tags/database/" class="post-tag no-text-decoration" >DataBase</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Spring DB - 스프링을 통한 트랜잭션 동작 개선 - My Technical Diary&amp;url=https://issuh.github.io/posts/spring-db-04/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Spring DB - 스프링을 통한 트랜잭션 동작 개선 - My Technical Diary&amp;u=https://issuh.github.io/posts/spring-db-04/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://issuh.github.io/posts/spring-db-04/&amp;text=Spring DB - 스프링을 통한 트랜잭션 동작 개선 - My Technical Diary" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/educative-distributed-system-10/">Distributed Systems - Coordination Patterns</a><li><a href="/posts/educative-distributed-system-04/">Distributed Systems - CAP</a><li><a href="/posts/educative-distributed-system-03/">Distributed Systems - Replication</a><li><a href="/posts/my_project_simpledb/">simpleDB - 메모리</a><li><a href="/posts/ps-hackerrank-01/">HackerRandk - Fraudulent Activity Notifications</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ps/">PS</a> <a class="post-tag" href="/tags/leetcode/">Leetcode</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/spring-framework/">Spring Framework</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/hash/">Hash</a> <a class="post-tag" href="/tags/database/">DataBase</a> <a class="post-tag" href="/tags/tree/">Tree</a> <a class="post-tag" href="/tags/array/">Array</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/spring-db-01/"><div class="card-body"> <em class="timeago small" data-ts="1697094600" > 2023-10-12 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring DB - JDBC 이해</h3><div class="text-muted small"><p> JDBC 표준 인터페이스 JDBC(Java Database Connectivity)는 자바에서 데이터베이스에 접속 할 수 있도록 하는 자바 API. JDBC는 데이터베이스에서 자료를 쿼리하거나 업데이트 하는 방법을 제공함 대표적으로 다음 3가지 기능을 표준 인터페이스로 정의해서 제공함 java.sql.Connection : 연결 java...</p></div></div></a></div><div class="card"> <a href="/posts/spring-db-02/"><div class="card-body"> <em class="timeago small" data-ts="1697163000" > 2023-10-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring DB - 커넥션풀과 데이터소스 이해</h3><div class="text-muted small"><p> 커넥션 풀 이해 데이터데이스 커넥션을 획득할 떄는 복잡한 과정을 걸치게 됨 어펄리케이션 로직은 DB 드라이버를 통해 커넥션 조회 DB 드라이버는 DB와 TCP/IP 커넥션 연결 DB 드라이버는 TCP/IP 커넥션이 연결되면 ID, PW와 기타 부가정보를 DB에 전달 DB는 ID, PW를 통해 내부 인증을 완료하고 내부에 DB 세션을...</p></div></div></a></div><div class="card"> <a href="/posts/spring-db-03/"><div class="card-body"> <em class="timeago small" data-ts="1697170200" > 2023-10-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring DB - 트랜잭션 이해</h3><div class="text-muted small"><p> 트랜잭션 데이터를 데이터베이스에 저장하는 대표적인 이유는 데이터베이스가 트랜잭션 이라는 개념을 지원하기 때문 트랜잭션이란 데이터베이스에서 하나의 작업을 안전하게 처리하도록 보장해주는 것을 뜻함 예를 들면, A가 B에게 1000원 계좌이체를 한다고 생각했을떄, A의 잔고 1000원 감소 B의 잔고 1000원 증가 위 두가지 작업이 합쳐 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/spring-db-03/" class="btn btn-outline-primary" prompt="Older"><p>Spring DB - 트랜잭션 이해</p></a> <a href="/posts/spring-mvc-01/" class="btn btn-outline-primary" prompt="Newer"><p>Spring MVC - MVC 패턴 개요</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/ISSuh">ISSuh</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ps/">PS</a> <a class="post-tag" href="/tags/leetcode/">Leetcode</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/spring-framework/">Spring Framework</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/hash/">Hash</a> <a class="post-tag" href="/tags/database/">DataBase</a> <a class="post-tag" href="/tags/tree/">Tree</a> <a class="post-tag" href="/tags/array/">Array</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-157715138-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-157715138-1'); }); </script>
