<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="OS - 스레드" /><meta property="og:locale" content="en" /><meta name="description" content="스레드" /><meta property="og:description" content="스레드" /><link rel="canonical" href="https://issuh.github.io/posts/os-ch4/" /><meta property="og:url" content="https://issuh.github.io/posts/os-ch4/" /><meta property="og:site_name" content="My Technical Diary" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-02-18T05:57:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="OS - 스레드" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-02-18T05:57:00+09:00","datePublished":"2020-02-18T05:57:00+09:00","description":"스레드","headline":"OS - 스레드","mainEntityOfPage":{"@type":"WebPage","@id":"https://issuh.github.io/posts/os-ch4/"},"url":"https://issuh.github.io/posts/os-ch4/"}</script><title>OS - 스레드 | My Technical Diary</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="My Technical Diary"><meta name="application-name" content="My Technical Diary"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/profile.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">My Technical Diary</a></div><div class="site-subtitle font-italic">ISSuh's tech blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/aboutme/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/ISSuh" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['yoyus5','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>OS - 스레드</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>OS - 스레드</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/ISSuh">ISSuh</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1581973020" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2020-02-18 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3712 words"> <em>20 min</em> read</span></div></div></div><div class="post-content"><h1 id="스레드">스레드</h1><ol><li><a href="#개요"> 개요 </a><li><a href="#다중코어-프로그래밍"> 다중코어 프로그래밍 </a><li><a href="#다중-스레드-모델"> 다중 스레드 모델 </a><li><a href="#암묵적-스레딩"> 암묵적 스레딩 </a><li><a href="#스레드-이슈"> 스레드 이슈 </a><li><a href="#운영체제-사례"> 운영체제 사례 </a></ol><h2 id="개요"><span class="mr-2">개요</span><a href="#개요" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>스레드는 CPU 이용의 기본단위이다.</p><p>스레드는 <strong>스레드 ID</strong>, <strong>프로그램 카운터</strong>, <strong>레지스터 집합</strong>, <strong>스택</strong> 으로 구성된다.</p><p>스레드는 같은 프로세스에 속한 다른 스레드와 코드, 데이터 섹션 그리고 열린 파일이나 신호와 같은 OS 자원을 공유한다.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: center"><img data-src="https://www2.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/images/Chapter4/4_01_ThreadDiagram.jpg" alt="figure_4.1.1" data-proofer-ignore><tbody><tr><td style="text-align: center"><em>단일 및 다중 스레드 프로세스</em></table></div><p>어떤 프로세스가 다수의 제어 스레드를 가진다면, 해당 프로세스는 동시에 하나 이상의 작업들을 수행할 수 있다.</p><h3 id="동기motivation"><span class="mr-2">동기(Motivation)</span><a href="#동기motivation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>다수의 OS 커널은 다중화 되어 있다. 커널 안에서 다수의 스레드가 동작하고 각 스레드는 장치 또는 인터럽트 처리 등의 특정 작업을 수행한다.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: center"><img data-src="https://www2.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/images/Chapter4/4_02_MultithreadedArchitecture.jpg" alt="figure_4.1.2" data-proofer-ignore><tbody><tr><td style="text-align: center"><em>다중 스레드 서버 구조</em></table></div><h3 id="장점"><span class="mr-2">장점</span><a href="#장점" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>다중 스레드 프로그래밍이 가지는 이점은 아래와 같다.</p><ul><li><strong>응답성(Responsiveness)</strong><ul><li>대화형 응용 프로그램을 다중 스레딩하면 응용 프로그램의 일부분이 봉쇄되거나, 응용 프로그램이 장시간 작업을 수행하더라도 프로그램의 수행이 계속 되는 것을 허용하여 사용자에 대한 응답성을 증가시킨다.</ul><li><strong>자원 공유(Resource Sharing)</strong><ul><li>스레드는 자동적으로 그들이 속한 프로세스의 자원들과 메모리를 공유한다. 즉 코드와 데이터 공유를 통해 같은 주소 공산내에 여러개의 다른 작업을 하는 스레드를 가진수 있다.</ul><li><strong>경제성(Economy)</strong><ul><li>프로세스 생성을 위해 메모리와 자원을 할당하는 것은 비용이 많이 든다.<li>스레드는 자신이 속한 프로세스의 자원들을 공유하기 때문에, 스레드를 생성하고 문맥 교환하는 것이 보다 더 경제적이다.</ul><li><strong>규모 적응성(Scalability)</strong><ul><li>다중 처리기 구조에서는 각각의 스레드가 다른 처리기에서 병렬로 수행될 수 있으므로 더욱 성능이 좋아진다.</ul></ul><h2 id="다중코어-프로그래밍"><span class="mr-2">다중코어 프로그래밍</span><a href="#다중코어-프로그래밍" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p><em>병렬 실행(Parallel Excution)</em> 과 <em>병행 실행(Concurrent Excution)</em></p><ul><li>병렬 실행<ul><li>하나 이상의 태스크를 동시에 수행할 수 있는 시스템에 대하여 병렬적 이라고 한다.</ul><li>병행 실행<ul><li>모든 태스크가 진행하도록 하여, 하나 이상의 태스크를 지원한다. 따라서 병렬 실행 없이 병행실행이 가능하게끔 한다.</ul></ul><div class="table-wrapper"><table><thead><tr><th style="text-align: center"><img data-src="https://www2.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/images/Chapter4/4_03_ConcurrentSingleCore.jpg" alt="figure_4.2.1" data-proofer-ignore><tbody><tr><td style="text-align: center"><em>단일코어 시스템에서의 병행 실행</em></table></div><div class="table-wrapper"><table><thead><tr><th style="text-align: center"><img data-src="https://www2.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/images/Chapter4/4_04_ParralelMulticore.jpg" alt="figure_4.2.2" data-proofer-ignore><tbody><tr><td style="text-align: center"><em>다중코어 시스템에서의 병렬 실행</em></table></div><h3 id="프로그래밍-챌린지"><span class="mr-2">프로그래밍 챌린지</span><a href="#프로그래밍-챌린지" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>다중코어 시스템을 위해 프로그래밍하기 위해, 아래와 같은 5개의 극복해야할 도전이 있다.</p><ul><li><strong>태스크 인식(Identifying Tasks)</strong><ul><li>개발하고자 하는 응용 프로그램을 분석하여 독립된 병행가능 태스크로 나눌수 있는 영역을 찾아야 한다.</ul><li><strong>균형(Balance)</strong><ul><li>찾아진 병렬실행 가능 부분들이 전체 작업에 균등한 기여도를 가지도록 태스크를 나누어야 한다.</ul><li><strong>데이터 분리(Data Spliting)</strong><ul><li>태스크가 접근하고 조작하는 데이터 또한 개별 작업에서 사용될수 있도록 나누어져야 한다.</ul><li><strong>데이터 의존성(Data Dependency)</strong><ul><li>태스크가 접근하는 데이터는 둘 이상의 태스크 사이에 종속성 및 의존성이 없는지 확인하여야 한다.<li>한 태스크가 다른 태스크로부터 오는 데이터에 종속적이거나 의존성이 있을때, 이를 수용할 수 있도록 태스트의 수행을 동기화하여 데이터 종속에 오는 문제를 회피한다.</ul><li><strong>테스트 및 디버깅(Testing and Debugging)</strong><ul><li>단일 스레드 프로그램의 테스트와 디버깅보다 난이도 있기때문에, 주의하여야 한다.</ul></ul><h3 id="병렬-실행의-유형"><span class="mr-2">병렬 실행의 유형</span><a href="#병렬-실행의-유형" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>일반적으로 <strong>데이터 병렬 실행</strong> 과 <strong>태스크 병렬 실행</strong> 두가지가 있다.</p><ul><li><strong>데이터 병렬 실행</strong><ul><li>동일한 데이터의 부분집합을 다수의 계산 코어에 분배한 뒤, 각 코어에서 동일한 연산을 실행하는데 초첨을 맞춘다.</ul><li><strong>태스크 병렬 실행</strong><ul><li>각 스테드는 고유의 연산을 수행한다.<li>각기 다른 스레드는 동일한 데이터에 대해연산을 실행할 수 있고, 또는 서로 다른 데이터에 연산을 실행할 수 있다.</ul></ul><h2 id="다중-스레드-모델"><span class="mr-2">다중 스레드 모델</span><a href="#다중-스레드-모델" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>스레드를 위한 자원은, <strong>사용자 스레드(User Thread)</strong> 를 위해서는 사용자 수준에서, 또는 <strong>커널 스레드(Kernel Thread)</strong> 를 위해서는 커널 수준에서 제공된다.</p><p>사용자 스레드는 커널 위에서 지원되며 커널의 지원 없이 관리된다. 반면 커널 스레드는 OS에 의해 직접 지원되고 관리된다.</p><h3 id="다대일-모델many-to-one-model"><span class="mr-2">다대일 모델(Many-to-One Model)</span><a href="#다대일-모델many-to-one-model" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote><p>많은 사용자 스레드를 하나의 커널 스레드로 매칭한 모델</p></blockquote><p>스레드 관리는 사용자 공간의 스레드 라이브러리에 의해 행해진다.</p><p>한 스레드가 블럭형 시스템콜을 호출 할 경우, 전체 프로세스가 블럭된다.</p><p>한번에 하나의 스레드만이 커널에 접근할 수 있기 때문에, 다중 스레드가 다중코어 시스템에서 병렬로 실행될 수 없다.</p><p>현대의 시스템에서는 거의 사용되지 않는다.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: center"><img data-src="https://www2.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/images/Chapter4/4_05_ManyToOne.jpg" alt="figure_4.3.1" data-proofer-ignore><tbody><tr><td style="text-align: center"><em>다대일 스레드 모델</em></table></div><h3 id="일대일-모델one-to-one-model"><span class="mr-2">일대일 모델(One-to-One Model)</span><a href="#일대일-모델one-to-one-model" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote><p>하나 사용자 스레드를 각각 하나의 커널 스레드로 매칭한 모델</p></blockquote><p>하나의 스레드가 블럭형 시스템콜을 호출 할 경우에도 다른 스레드가 실행될 수 있기 때문에 다대일 모델보다 더 많은 병렬성을 제공한다.</p><p>사용자 스레드를 생성할때, 그에 따른 커널 스레드를 생성해야 하므로, 오버헤드가 발생하여 성능저하가 일어날수 있다.</p><p>이 모델의 대부분의 구현은 시스템에 의해 지원되는 스레드의 수를 제한한다.</p><p>Windows 계열과, Linux가 일대일 모델을 구현하고 있다.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: center"><img data-src="https://www2.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/images/Chapter4/4_06_OneToOne.jpg" alt="figure_4.3.2" data-proofer-ignore><tbody><tr><td style="text-align: center"><em>일대일 스레드 모델</em></table></div><h3 id="다대다-모델many-to-many-model"><span class="mr-2">다대다 모델(Many-to-Many Model)</span><a href="#다대다-모델many-to-many-model" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote><p>여러개의 사용자 스레드를 그보다 작은 수, 혹은 같은 수의 커널 스레드로 매칭한 모델</p></blockquote><p>한번에 하나의 스레드만이 커널에의해 스케쥴링 되기 때문에 진정한 병렬 실행을 이룰수 없다.</p><p>개발자는 일대일 모델과 달리 다대다 모델의 시스템에서는 필요한 만큼 사용자 스레드를 생성할 수 있다.</p><p>어떤 스레드가 블럭형 시스템콜을 호출했을때, 커널이 다른 스레드의 수행을 스케쥴링할 수 있다.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: center"><img data-src="https://www2.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/images/Chapter4/4_07_ManyToMany.jpg" alt="figure_4.3.3" data-proofer-ignore><tbody><tr><td style="text-align: center"><em>다대다 스레드 모델</em></table></div><h3 id="두-수준-모델two-level-model"><span class="mr-2">두 수준 모델(Two-level Model)</span><a href="#두-수준-모델two-level-model" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote><p>다대다 모델의 변형으로써, 많은 사용자 스레스를 적거나 같은수의 커널 스레드와 매칭하지만, 또한 한 사용자 스레드가 하나의 커널 스레드에서만 매칭되는것을 허용</p></blockquote><div class="table-wrapper"><table><thead><tr><th style="text-align: center"><img data-src="https://www2.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/images/Chapter4/4_08_TwoLevel.jpg" alt="figure_4.3.4" data-proofer-ignore><tbody><tr><td style="text-align: center"><em>두 수준 모델</em></table></div><h2 id="암묵적-스레딩"><span class="mr-2">암묵적 스레딩</span><a href="#암묵적-스레딩" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p><strong>암묵적 스레딩(Implicit Threading)</strong> 이란, 스레딩 생성과 관리 책임을 컴파일러와 실행시간 라이브러리에게 넘겨주는 방식이다.</p><h2 id="스레드-이슈"><span class="mr-2">스레드 이슈</span><a href="#스레드-이슈" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><h3 id="fork-및-exec-시스템-호출"><span class="mr-2">Fork() 및 Exec() 시스템 호출</span><a href="#fork-및-exec-시스템-호출" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>다중 스레드 프로그램에서는 fork()와 exec()의 의미가 달라질 수 있다.</p><p>만일 하나의 프로그램의 스레드가 fork()를 호출하면, 해당 자식 프로세스는 부모 프로세스의 모든 스레드를 복제하여 가질 수 있고, fork()를 호출한 스레드만 복제하여 가질 수 있다.</p><h3 id="신호-처리signal-handling"><span class="mr-2">신호 처리(Signal Handling)</span><a href="#신호-처리signal-handling" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>신호</strong> 는 UNIX에서 프로세스에게 어떤 사건이 일어났음을 알려주기 위해 사용된다.</p><p>신호는 알려줄 사건의 근원지나 이유에 따라 <em>동기식</em> 과 <em>비동기식</em> 으로 전달될 수 있다.</p><p>모든 신호는 다음과 같은 형태로 전달된다.</p><ul><li>신호는 특정 사건이 일어나야 생성된다.<li>생성된 신호가 프로세스에게 전달된다.<li>신호가 전달되면 반드시 처리되어야 한다.</ul><p>동기식 신호의 예로는 불법적인 메모리 접근, 0으로 나누기 등이 있다. 동기식 신호는 신호를 발생시킨 프로세스에게 전달된다.</p><p>신호가 발생중인 프로세스 외부로부터 발생되면, 그 프로세스는 신호를 비동기식으로 전달 받는다. 비동기식 신호의 예로는 “CRTL + C”와 같은 특수한 키를 눌러 프로세스를 강제 종료 하거나 타이머가 만료되는 경우 이다.</p><p>모든 신호는 둘 중 하나의 처리기에 의해 처리된다.</p><ul><li>디폴트 신호 처리기(Default Signal Handler)<li>사용자 정의 신호 처리기(User Design Signal Handler)</ul><p>모든 신호마다 커널이 실행시키는 디폴트 신호 처리기가 있다. 이 디폴트 신호 처리기는 신호를 처리하기 위해 사용자 정의 신호 처리기로 대체될 수 있다.</p><p>다중 스레드 프로그램에서 신호를 전달한 스레드를 선택할 때, 다음과 같은 방법이 존재한다.</p><ul><li>신호가 적용될 스레드에게 전달<li>모든 스레드에게 전달<li>몇몇 스레드에게만 선택적으로 전달<li>특정 스레드가 모든 신호를 전달 받도록 지정</ul><h3 id="취소cancellations"><span class="mr-2">취소(Cancellations)</span><a href="#취소cancellations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>스레드 취소는 스레드가 끝나기 전에 그것을 강제 종료 시키는 작업이다.</p><p>스레드의 취소는 두가지 방법으로 발생할 수 있다.</p><ul><li><strong>비동기식 취소(Asynchronous Cancellation)</strong><ul><li>한 스레드가 즉시 취소 시킬 스레드를 강제 종료 시킨다.</ul><li><strong>지연 취소(Deferred Cancellation)</strong><ul><li>취소할 스레드가 주기적으로 자신이 강제 종료 되어야 할지 점검한다.</ul></ul><p>스레드 취소를 어렵게 만드는 것은 취소 스레드들에게 할당된 자원 문제이다. 또한 스레드가 다른 스레드와 공유하는 자료구조를 갱신하는 도중에 취소 요청이 와도 문제가 된다.</p><h3 id="스레드-로컬-저장소thread-local-storage"><span class="mr-2">스레드 로컬 저장소(Thread Local Storage)</span><a href="#스레드-로컬-저장소thread-local-storage" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>한 프로세스에 속한 스레드들은 그 프로세스의 데이터를 모두 공유한다. 그러나 스레드는 때로 자신만 액세스 할 수 있는 데이터를 가져야 할 필요가 있다. 이러한 데이터를 <strong>스레드 로컬 저장소(Thread Local Storage)</strong> 이라고 한다.</p><p>TLS를 지역변수와 혼동하기 쉬운데, 지역변수는 하나의 함수가 호출되는 동한에만 보이는 반면, TLS는 전체 함수 호출에 걸쳐 보인다.</p><h3 id="스케쥴러-액티베이션scheduler-activation"><span class="mr-2">스케쥴러 액티베이션(Scheduler Activation)</span><a href="#스케쥴러-액티베이션scheduler-activation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>다대다 또는 두 수준 모델을 가진 많은 시스템들은 사용자와 커널 스레드 사이에 중간 자료구조를 둔다. 해당 자료구조를 <strong>경량 프로세스(LWP)</strong> 라고 한다.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: center"><img data-src="https://www2.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/images/Chapter4/4_13_Lightweight.jpg" alt="figure_4.5.1" data-proofer-ignore><tbody><tr><td style="text-align: center"><em>경량 프로세스(LWP)</em></table></div><p>사용자 스레드 라이브러리와 커널 스레드 간의 통신 방법중 하나는 <strong>스케쥴러 액티베이션(Scheduler Activation)</strong> 이다.</p><h2 id="운영체제-사례"><span class="mr-2">운영체제 사례</span><a href="#운영체제-사례" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><h4 id="windows-스레드"><span class="mr-2">Windows 스레드</span><a href="#windows-스레드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>Windows에서는 일대일 스레드 모델을 사용한다.</p><p>스레드와 일반적인 구성요소는 다음과 같다.</p><ul><li>스레드 ID<li>처리기의 상태를 나타내는 레지스터 집합<li>사용자 모드에서 실행될 때 필요한 사용자 스택, 커널 모드에서 실행될 때 필요한 커널 스택<li>실행 시간 라이브러리와 동적 링크 라이브러리(DLL) 등이 사용하는 개별 데이터 저장 영역</ul><p>레지스터 집합, 스택, 개별 데이터 저장 영역들은 그 스레드의 문맥으로 불린다. 스레드를 위해서는 아래와 같은 자료구조를 가진다.</p><ul><li>ETHERAD - 실행 스레드 블록(Executive Thread Block)<ul><li>스레드가 속한 프로세스를 가리키는 포인터와 그 스레드가 실행해야할 루틴의 주소를 가짐<li>KTHREAD에 대한 포인터를 가짐</ul><li>KTHREAD - 커널 스레드 블록(Kernel Thread Block)<ul><li>스레드의 스케쥴링 및 동기화 정보를 가짐<li>해당 스레드가 커널코드에서 실행될 때 사용되는 커널 스택과 TEBdp에 대한 포인터를 가짐</ul><li>TEB - 스레드 환경 블록(Thread Environment Block)<ul><li>사용자 모드에서 실행될 때 접근되는 사용자 공간 자료구조<li>스레드 ID, 사용자 모드 스택, 스레드 로컬 저장소를 저장하기 위한 배열을 가짐</ul></ul><div class="table-wrapper"><table><thead><tr><th style="text-align: center"><img data-src="https://www2.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/images/Chapter4/4_14_WindowsThreadStructures.jpg" alt="figure_4.6.1" data-proofer-ignore><tbody><tr><td style="text-align: center"><em>Windows 스레드의 자료구조</em></table></div><p>ETHREAD와 KTHREAD는 모두 커널안에 존재한다.</p><h4 id="linux-스레드"><span class="mr-2">Linux 스레드</span><a href="#linux-스레드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>Linux는 프로세스를 복제하는 기능을 가진 fork() 시스템콜과 clone() 시스템콜을 이용하여 스레드를 생성할 수 있다.</p><p>Linux는 프로세스와 스레드를 구별하지 않는다. 사실 Linux는 프로그램 내의 제어 흐을을 나타내기 위해 <em>프로세스</em> 나 <em>스레드</em> 보다 <em>태스크</em> 라는 용어를 사용한다.</p><p>clone()이 호출될 때, 부모와 자식 태스크가 자료구조를 얼마나 공유 할 것인지 결정하는 플레그의 집합이 전달된다.</p><div class="table-wrapper"><table><thead><tr><th>flag<th>Meaning<tbody><tr><td>CLONE_FS<td>파일 시스템 정보가 공유<tr><td>CLONE_VM<td>같은 메모리 공간이 공유<tr><td>CLONE_SIGHAND<td>신호 처리기가 공유<tr><td>CLONE_FILES<td>열린 파일의 집합이 공유</table></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/operating-system/'>Operating System</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/os/" class="post-tag no-text-decoration" >OS</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=OS - 스레드 - My Technical Diary&amp;url=https://issuh.github.io/posts/os-ch4/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=OS - 스레드 - My Technical Diary&amp;u=https://issuh.github.io/posts/os-ch4/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://issuh.github.io/posts/os-ch4/&amp;text=OS - 스레드 - My Technical Diary" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/educative-distributed-system-10/">Distributed Systems - Coordination Patterns</a><li><a href="/posts/educative-distributed-system-04/">Distributed Systems - CAP</a><li><a href="/posts/educative-distributed-system-03/">Distributed Systems - Replication</a><li><a href="/posts/my_project_simpledb/">simpleDB - 메모리</a><li><a href="/posts/ps-hackerrank-01/">HackerRandk - Fraudulent Activity Notifications</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ps/">PS</a> <a class="post-tag" href="/tags/leetcode/">Leetcode</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/spring-framework/">Spring Framework</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/hash/">Hash</a> <a class="post-tag" href="/tags/database/">DataBase</a> <a class="post-tag" href="/tags/tree/">Tree</a> <a class="post-tag" href="/tags/array/">Array</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/os-ch1/"><div class="card-body"> <em class="timeago small" data-ts="1581370440" > 2020-02-11 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OS - 개요</h3><div class="text-muted small"><p> 개요 운영체제가 하는 일 컴퓨터 시스템의 구성 컴퓨터 시스템의 구조 운영체제의 구조 운영체제의 연산 프로세스 관리 메모리 관리 저장장치 관리 운영체제가 하는 일 컴퓨터 시스템은 대게 네 가지 구성 요소인 하드웨어, 운영체제, 응용 프로그램, 사용자 로 구분할 수 있다. 하드웨어 는 ...</p></div></div></a></div><div class="card"> <a href="/posts/os-ch2/"><div class="card-body"> <em class="timeago small" data-ts="1581541740" > 2020-02-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OS - 시스템 구조</h3><div class="text-muted small"><p> 시스템 구조 운영체제 서비스 시스템 호출 시스템 호출의 유형 시스템 프로그램 운영체제 설계 및 구현 운영체제 구조 운영체제 서비스 운영체제는 프로그램의 실행 환경을 제공한다. 운영체제가 사용자에게 제공하는 서비스의 종류 사용자 인터페이스(User Interface) Com...</p></div></div></a></div><div class="card"> <a href="/posts/os-ch3/"><div class="card-body"> <em class="timeago small" data-ts="1581634680" > 2020-02-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OS - 프로세스</h3><div class="text-muted small"><p> 프로세스 프로세스 개념 프로세스 스케쥴링 프로세스에 대한 연산 프로세스간 통신 프로세스 개념 일괄저리 시스템은 잡(Job) 들을 실행하는 반면세, 시분할 시스템은 사용자 프로그램 또는 태스크(Task) 를 가진다. 이와같은 것들을 프로세스(Process) 라고 한다. 프로세스(Process) 프로세스란 실행중인...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ps-leetcode-998/" class="btn btn-outline-primary" prompt="Older"><p>LeetCode - 998. Maximum Binary Tree II</p></a> <a href="/posts/ps-leetcode-1104/" class="btn btn-outline-primary" prompt="Newer"><p>LeetCode - 1104. Path In Zigzag Labelled Binary Tree</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/ISSuh">ISSuh</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ps/">PS</a> <a class="post-tag" href="/tags/leetcode/">Leetcode</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/spring-framework/">Spring Framework</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/hash/">Hash</a> <a class="post-tag" href="/tags/database/">DataBase</a> <a class="post-tag" href="/tags/tree/">Tree</a> <a class="post-tag" href="/tags/array/">Array</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-157715138-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-157715138-1'); }); </script>
