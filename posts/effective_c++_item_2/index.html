<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Effective C++ - Item.2" /><meta property="og:locale" content="en" /><meta name="description" content="#define을 쓰려거든 const, enum, inline을 떠올리자" /><meta property="og:description" content="#define을 쓰려거든 const, enum, inline을 떠올리자" /><link rel="canonical" href="https://issuh.github.io/posts/effective_c++_item_2/" /><meta property="og:url" content="https://issuh.github.io/posts/effective_c++_item_2/" /><meta property="og:site_name" content="My Technical Diary" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-04-11T02:03:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Effective C++ - Item.2" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-04-11T02:03:00+09:00","datePublished":"2020-04-11T02:03:00+09:00","description":"#define을 쓰려거든 const, enum, inline을 떠올리자","headline":"Effective C++ - Item.2","mainEntityOfPage":{"@type":"WebPage","@id":"https://issuh.github.io/posts/effective_c++_item_2/"},"url":"https://issuh.github.io/posts/effective_c++_item_2/"}</script><title>Effective C++ - Item.2 | My Technical Diary</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="My Technical Diary"><meta name="application-name" content="My Technical Diary"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/profile.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">My Technical Diary</a></div><div class="site-subtitle font-italic">ISSuh's tech blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/aboutme/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/ISSuh" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['yoyus5','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Effective C++ - Item.2</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Effective C++ - Item.2</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/ISSuh">ISSuh</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1586538180" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2020-04-11 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2275 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><h1 id="define을-쓰려거든-const-enum-inline을-떠올리자">#define을 쓰려거든 const, enum, inline을 떠올리자</h1><blockquote><p>가급적 전처리기(Preprocessor) 보다 컴파일러를 가까이 하자</p></blockquote><p>  <em>#define</em>의 경우 전처리기에서 이미 치환시켜 값을 대입하기 때문에 컴파일러가 쓰는 기호 테이블에 값이 들어가지 않는다. 따라서 숫자 상수로 대체된 코드에서 컴파일 에러가 발생한다면 이를 디버깅하기가 쉽지 않다. 이 문제는 마찬가지로 기호 테이블에 이름이 들어가 있지 않기 때문에 기호식 디버거(Symbolic Debugger)에서도 나타날 수 있다.</p><p>이를 해결하기위해 매크로를 대신하여 상수 변수를 사용한다.</p><p>상수 변수는 언어 차원에서 지원하는 상수 타입의 데이터이기 때문에 컴파일러가 인식할수 있으며 기호 테이블에도 들어가게 된다.</p><p>또한 만약 상수가 부동소수점 실수 타입일 경우 컴파일을 거친 최종 코드의 크기가 <em>#define</em>보다 작게 나올수 있다. 매크로를 사용하면 정의한 매크로가 등장하는 코드마다 전처리기에 의해 값이 치환되면서 결국 코드 안에 값의 사본이 등장하는 만큼 들어가게 되지만, 상수 타입의 변수는 아무리 여러번 쓰이더라도 사본은 딱 한개만 생기게 된다.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="cp">#define ASPECT_RATIO 1.653        // bad
</span><span class="k">const</span> <span class="kt">double</span> <span class="n">AspectRatio</span> <span class="o">=</span> <span class="mf">1.653</span>  <span class="c1">// Good</span>
</pre></table></code></div></div><hr /><p>  <em>#define</em> 을 상수로 교체할 때 두가지를 고려해야 한다.</p><ul><li>상수 포인터(Constant Pointer) 정의를 하는 경우<li>클래스 멤버로 상수를 정의하는 경우, 즉 클래스 상수를 정의하는 경우</ul><p>  <em>상수 포인터</em>를 정의하는 경우, 상수 정의는 대게 헤더파일에 넣는 것이 일반적이므로 <em>포인터는 꼭 const로 선언해 주어야 하고, 이와 아울러 포인터가 가리키는 대상까지 const로 선언</em>하는 것이 보통이다.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1">// 상수 포인터를 정의 할때는 포인터와 가리키는 값 모두 const로 선언한다.</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="k">const</span> <span class="n">authorName</span> <span class="o">=</span> <span class="s">"InSeock Suh"</span><span class="p">;</span>

<span class="c1">// 문자열 상수를 사용할때는 string 객체를 사용한다.</span>
<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="nf">authorName</span><span class="p">(</span><span class="s">"InSeock Suh"</span><span class="p">);</span>
</pre></table></code></div></div><p>  어떤 상수의 유효범위를 클래스로 한정하고자 할때, 그 상수를 멤버로 만들어야 하는데, 그 상수의 사본 개수가 한개를 넘지 못하게 하고자 하면 <strong>정적 맴버(static member)</strong> 로 만들어야 한다.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">GamePlayer</span> <span class="p">{</span>
<span class="nl">private:</span>
  <span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">NumTurns</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>  <span class="c1">// 정적 클래스 상수 선언. '정의' 아님을 주의</span>
  <span class="kt">int</span> <span class="n">scores</span><span class="p">[</span><span class="n">NumTurns</span><span class="p">];</span>           <span class="c1">// 상수를 사용하는 부분</span>

  <span class="p">...</span>

<span class="p">};</span>
</pre></table></code></div></div><p>C++에서는 사용하고자 하는 것에 대한 <em>정의</em>가 마련되는것이 보통이지만, <em>정적 멤버</em>로 만들어지는 정수류(각종 정수타입, char, bool등) 타입의 클래스 내부 상수는 예외이다. 이들에 대해선 주소를 취하지 않는 한, 정의없이 선언만 해도 아무 문제없다. 그러나 클래스 상수의 주소를 구한다던지, 잘못 구현된 컴파일러가 정의를 달라고 하는 경우에는 별도의 정의를 제공해야 한다.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">const</span> <span class="kt">int</span> <span class="n">GamePlayer</span><span class="o">::</span><span class="n">NumTurns</span><span class="p">;</span>   <span class="c1">// 정적 클래스 상수 정의</span>
</pre></table></code></div></div><p>이때 클래스 상수의 정의는 구현파일에 둔다. 헤더 파일에 두지 않는다.</p><p>정의에는 상수의 초기값이 오면 안 되는데, 그 이유는 클래스 상수의 초기값은 해당 상수가 선언된 시점에서 바로 주어지기 때문이다. 즉, 위의 예에서 <em>NumTurns</em> 변수는 선언될 당시에 바로 초기화 된다.</p><p>이때 주의해야 할 점은, <em>#define</em>은 유효범위의 개념이 존재 하지 않기 때문에 일단 정의되면 컴파일이 끝날 때 까지(중간에 <em>#undef</em> 되지 않으면) 유효하게 된다. 즉, <em>#define</em>은 클래스 상수를 정의하는데 쓸수 없을 뿐만 아니라 어떤 형태의 캡슐화 혜택도 받을 수 없다.(‘private’ 성격의 <em>#define</em>은 존재하지 않는다)</p><p>조금 오래된 컴파일러는 위의 문법을 받아들이지 않는 경우가 있다. 이는 컴파일러에서 정적 클래스 멤버가 선언된 시점에 초기값을 주는 것이 대개 맞지 않다고 판단하기 때문이다. 이와 같은 경우에는 아래와 같이 한다.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">CostEstimate</span> <span class="p">{</span>
<span class="nl">private:</span>
  <span class="k">static</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">FudgeFactor</span><span class="p">;</span>  <span class="c1">// 정적 클래스 상수 선언</span>
                                    <span class="c1">// 이것은 헤더파일에 위치</span>
  <span class="p">...</span>

<span class="p">};</span>

<span class="k">const</span> <span class="kt">double</span> <span class="n">CostEstimate</span><span class="o">::</span><span class="n">FudgeFactor</span> <span class="o">=</span> <span class="mf">1.35</span><span class="p">;</span>  <span class="c1">// 정적 클래스 상수 정의</span>
                                                <span class="c1">// 이것은 구현 파일에 위치</span>
</pre></table></code></div></div><hr /><p>  웬만한 경우에는 위의 예제만으로 충분하다. 딱 한가지 예외가 있다면 해당 클래스를 컴파일 하는 도중에 클래스 상수의 값이 필요할 때 이다. 이를테면 <em>GamePlayer::scores</em> 등의 배열 멤버를 선언할 때 이다. 즉 컴파일러는 컴파일 과정에서 이 배멸의 크기를 알아야 선언 가능하므로 컴파일 타임에 상수의 값을 요구할 것이다. 이런경우에 대한 대안으로는 <em>Enum Hack</em> 이라는 기법을 사용할 수 있다.</p><p><em>Enum Hack</em> 은 <em>enum</em> 타입의 값은 int 가 놓일 곳에도 쓸수 있는 C++의 문법을 활용하여 상수처럼 사용하는 것이다.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">GamePlayer</span> <span class="p">{</span>
<span class="nl">private:</span>
  <span class="k">enum</span> <span class="p">{</span> <span class="n">NumTurns</span> <span class="o">=</span> <span class="mi">5</span> <span class="p">};</span>  <span class="c1">// 'Enum Hack'</span>
                          <span class="c1">// NumTurn를 5에 대한 기호식 이름으로 표현</span>

  <span class="kt">int</span> <span class="n">scores</span><span class="p">[</span><span class="n">NumTurns</span><span class="p">];</span>
<span class="p">};</span>
</pre></table></code></div></div><p><em>Enum Hack</em>의 동작 방식은 <em>const</em> 보다 <em>#define</em>에 더 가깝게 동작하며, 이를 이용한 <em>Enum Hack</em> 기법의 특징은 아래와 같다.</p><ul><li><em>Enum Hack</em> 기법의 상수에 대해서 참조나 주소를 얻을수 없다.<ul><li><em>const</em> 변수의 주소를 잡아내는 것은 합당하지만, <em>enum</em>의 주소를 취하는 것은 불법이며 <em>#define</em>의 주소를 얻는 것 역시 마찬가지 이다.</ul><li><em>enum</em> 타입은 <em>#define</em> 처럼 어떤 형태의 쓸데없는 메모리 할당을 하지 않는다.<li>이미 <em>Enum Hack</em>기법은 상당히 많은 코드에서 쓰이고 있으며 <em>템플릿 메타프로그래밍</em>의 핵심 기법이다.</ul><hr /><p>  <em>#define</em>의 또다른 오용 사례는 매크로 함수 이다.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1">// a와 b 중에 큰 것을 함수 f에 넘겨 호출한다.</span>
<span class="cp">#define CALL_WITH_MAX(a, b) f( (a) &gt; (b) ? (a) : (b) )
</span>
<span class="p">...</span>

<span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="n">CALL_WITH_MAX</span><span class="p">(</span><span class="o">++</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>        <span class="c1">// a가 두번 증가한다.</span>
                              <span class="c1">// ++a &gt; b ? ++a : b;</span>

<span class="n">CALL_WITH_MAX</span><span class="p">(</span><span class="o">++</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">10</span><span class="p">);</span>   <span class="c1">// a가 한번 증가한다.</span>
                              <span class="c1">// ++a &gt; b+10 ? ++a : b+10;</span>

                              <span class="c1">// f가 호출되기 전에 a가 증가하는 횟수가 달라진다.</span>
</pre></table></code></div></div><p>위와같은 문제를 피하기 위해, 기존 매크로의 효율을 그대로 유지하면서 정규 함수의 모든 동작방식 및 타입 안정성까지 완벽히 취할 수 있는 방법으로는 <em>inline 함수에 대한 템플릿</em>을 준비하는 것이다.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">callWithMax</span><span class="p">(</span><span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">){</span>
  <span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span> <span class="o">?</span> <span class="n">a</span> <span class="o">:</span> <span class="n">b</span><span class="p">);</span>   <span class="c1">// T가 정확이 무엇인지 모르기 때문에,</span>
<span class="p">}</span>                     <span class="c1">// 상수 객체에 대한 참조자를 사용한다.(Item. 20 참조)</span>
</pre></table></code></div></div><p>이 함수는 템플릿이기 때문에 <strong>동일 계열 함수군(family of function</strong> : 하나의 템플릿을 통해 만들어 질것으로 예측 가능한 모든 함수들의 집합 <strong>)</strong> 을 만들어 낸다. 또한 <em>callWithMax</em>는 진짜 함수이기 때문에 유효범위 및 접근 규칙을 그대로 따라가며 인자를 여러번 평가할지도 모른다는 걱정도 없어지게 된다.</p><hr /><p>  <em>const</em>, <em>enum</em>, <em>inline</em> 의 존재를 늘 유념해 두면, 전처리기(특히 <em>#define</em>)를 꼭 써야 하는 경우가 많이 줄어들게 된다. 그렇다고 현실적으로 완전히 뿌리뽑기는 힘들다. 예를 들어 <em>#include</em>는 부동의 필수 요소로 남아 있고, <em>#iddef</em>, <em>#ifndef</em>도 컴파일 조정 기능으로 현장에서 자주 쓰이고 있다.</p><h3 id="요점"><span class="mr-2">요점</span><a href="#요점" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote><p>단순한 상수를 쓸 떄는 <em>#define</em>보다 <em>const</em> 객체 혹은 <em>enum</em>을 우선 생각한다. 함수처럼 쓰이는 매크로를 만드려면, <em>#define</em> 매크로보다 <em>inline</em> 함수를 우선 생각한다.</p></blockquote><hr /><hr /><p><em>참고</em>. Effective C++ 3/E - Scott Meyers</p><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/c/'>C++</a>, <a href='/categories/effective-c/'>Effective C++</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/c/" class="post-tag no-text-decoration" >C++</a> <a href="/tags/effective-c/" class="post-tag no-text-decoration" >Effective C++</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Effective C++ - Item.2 - My Technical Diary&amp;url=https://issuh.github.io/posts/effective_c++_item_2/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Effective C++ - Item.2 - My Technical Diary&amp;u=https://issuh.github.io/posts/effective_c++_item_2/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://issuh.github.io/posts/effective_c++_item_2/&amp;text=Effective C++ - Item.2 - My Technical Diary" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/educative-distributed-system-10/">Distributed Systems - Coordination Patterns</a><li><a href="/posts/educative-distributed-system-04/">Distributed Systems - CAP</a><li><a href="/posts/educative-distributed-system-03/">Distributed Systems - Replication</a><li><a href="/posts/my_project_simpledb/">simpleDB - 메모리</a><li><a href="/posts/ps-hackerrank-01/">HackerRandk - Fraudulent Activity Notifications</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ps/">PS</a> <a class="post-tag" href="/tags/leetcode/">Leetcode</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/spring-framework/">Spring Framework</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/hash/">Hash</a> <a class="post-tag" href="/tags/database/">DataBase</a> <a class="post-tag" href="/tags/tree/">Tree</a> <a class="post-tag" href="/tags/array/">Array</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/effective_c++_item_1/"><div class="card-body"> <em class="timeago small" data-ts="1586535060" > 2020-04-11 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Effective C++ - Item.1</h3><div class="text-muted small"><p> C++를 언어들의 연합체로 바라보는 안목은 필수 오늘날의 C++는 다중패러다임 프로그래밍 언어(Multiparadigm Programming Language) 라고 불리운다. 절차적(Procedural) 프로그래밍 을 기본으로 하여 객체 지향(Object Oriented) , 함수식(Functional) , 일반화(Generic) 프로그래밍을 포함...</p></div></div></a></div><div class="card"> <a href="/posts/effective_c++_item_3/"><div class="card-body"> <em class="timeago small" data-ts="1588245780" > 2020-04-30 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Effective C++ - Item.3</h3><div class="text-muted small"><p> 낌새만 보이면 const를 들이대 보자! 내용 Const 키워드 const의 가장 눈에 띄는 특징이라면, const가 붙은 객체는 외부 변경을 불가능 하게 한다라는 ‘의미적인 제약’을 소스코드 수준에서 행해진다는 점과 컴파일러가 이 제약을 단단히 지켜준다는 점이다. const 키워드는 클래스 바깥에서 전역 혹은 네임스페이스 유효범위의 상수를...</p></div></div></a></div><div class="card"> <a href="/posts/effective_c++_item_4/"><div class="card-body"> <em class="timeago small" data-ts="1588252500" > 2020-04-30 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Effective C++ - Item.4</h3><div class="text-muted small"><p> 객체를 사용하기 전에 반드시 그 객체를 초기화하자 내용 객체의 초기화 초기화되지 않은 값을 읽도록 내버려 두면 정의되지 않은 동작이 그대로 흘러 나오게 된다. 일반적인 경우에 적당히 무작위 비트의 값을 읽고 객체의 내부가 이상한 값을 가지게 된다. C++에서 객체의 초기화 보장 유무 C++의 객체(변수) 초기화가 중구난방인 것은 절대 아니...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/effective_c++_item_1/" class="btn btn-outline-primary" prompt="Older"><p>Effective C++ - Item.1</p></a> <a href="/posts/design_patterns-factory_method/" class="btn btn-outline-primary" prompt="Newer"><p>Design Patterns - Factory Method</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/ISSuh">ISSuh</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ps/">PS</a> <a class="post-tag" href="/tags/leetcode/">Leetcode</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/spring-framework/">Spring Framework</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/hash/">Hash</a> <a class="post-tag" href="/tags/database/">DataBase</a> <a class="post-tag" href="/tags/tree/">Tree</a> <a class="post-tag" href="/tags/array/">Array</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-157715138-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-157715138-1'); }); </script>
